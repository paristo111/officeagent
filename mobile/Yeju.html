<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MOBILE OFFICE // EXHIBITION</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        @import url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap");

        html,
        body {
            height: 100%;
            background: #ffffff;
        }

        body {
            font-family: "JetBrains Mono", "Courier New", Courier, monospace;
            color: #000000;
            cursor: crosshair;
        }

        /* Raw Scrollbar */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #ffffff;
            border-left: 1px solid #000;
        }

        ::-webkit-scrollbar-thumb {
            background: #000;
            border: 2px solid #fff;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #000;
        }

        ::selection {
            background: #000;
            color: #fff;
        }
    </style>
</head>

<body class="min-h-screen overflow-x-hidden selection:bg-black selection:text-white">
    <!-- MOBILE TOP BAR (always visible) -->
    <div class="fixed top-0 left-0 right-0 z-40 bg-white border-b border-black md:hidden">
        <div class="px-4 py-3 flex items-center justify-between text-[10px] font-bold uppercase tracking-widest">
            <a href="https://officeagent.vercel.app/" target="_blank" rel="noopener noreferrer"
                class="hover:bg-black hover:text-white px-1">
                오피스
            </a>
            <span class="opacity-60">최예주</span>
        </div>
    </div>

    <!-- FIXED LABELS (desktop only) -->
    <div
        class="fixed left-4 md:left-8 top-8 text-[10px] font-bold text-black uppercase tracking-widest z-30 hidden md:block">
        <a href="https://officeagent.vercel.app/" target="_blank" rel="noopener noreferrer"
            class="hover:bg-black hover:text-white px-1">
            오피스
        </a>
    </div>
    <div
        class="fixed left-4 md:left-8 top-1/2 -translate-y-1/2 text-[10px] font-bold text-black uppercase tracking-widest z-30 hidden md:block">
        최예주
    </div>
    <div
        class="fixed right-4 md:right-8 top-1/2 -translate-y-1/2 text-[10px] font-bold text-black uppercase tracking-widest z-30 hidden md:block">
        모닥불
    </div>

    <!-- MAIN APP CONTAINER -->
    <main id="app" class="w-full max-w-3xl mx-auto px-6 pt-28 pb-24 md:py-32 flex flex-col items-center relative">
    </main>

    <script type="module">
        import { GoogleGenAI } from "https://esm.sh/@google/genai@^1.34.0";

        // --- CONSTANTS ---
        const SAMPLE_ARTWORKS = [
            {
                id: "001",
                title: "STRUCTURE_VOID_09",
                artist: "SYSTEM_ARCHITECT",
                year: "2024",
                medium: "Digital Pigment Print on Aluminum",
                description:
                    "An exploration of brutalist forms in digital space. The void represents the absence of bureaucratic friction.",
                status: "AVAILABLE",
                lotNumber: "LOT-2024-X-09",
            },
            {
                id: "002",
                title: "MEMORY_LEAK_V2",
                artist: "NULL_POINTER",
                year: "2023",
                medium: "Oil and Acrylic on Canvas",
                description:
                    "Visualizing data corruption through traditional media. Layers of paint mimic overwritten memory sectors.",
                status: "RESERVED",
                lotNumber: "LOT-2023-M-02",
            },
            {
                id: "003",
                title: "SIGNAL_NOISE",
                artist: "HERTZ_COLLECTIVE",
                year: "2025",
                medium: "Kinetic Sculpture / Mixed Media",
                description:
                    "A responsive installation that translates ambient electromagnetic waves into mechanical movement.",
                status: "SOLD",
                lotNumber: "LOT-2025-S-11",
            },
        ];

        // --- STATE ---
        let selectedArtworkId = null;
        let analysisData = {}; // { [id]: string }
        let isAnalyzing = false;

        // --- GEMINI SERVICE ---
        async function analyzeArtwork(artwork) {
            // NOTE: 브라우저에서 process.env는 보통 undefined라서,
            // 데모용으로는 아래처럼 메시지 리턴만 하게 둠 (기존 로직 유지)
            if (!process?.env?.API_KEY) {
                return "ERROR: API_KEY_MISSING. UNABLE_TO_INITIATE_ANALYSIS_PROTOCOL.";
            }

            try {
                const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });

                const parts = [
                    {
                        text: `Analyze this artwork titled "${artwork.title}". Provide a critique in the style of a cold, bureaucratic art critic or a system administrator logging a file report. Use technical jargon mixed with art theory. Keep it under 100 words. Output format: Plain text.`,
                    },
                ];

                const response = await ai.models.generateContent({
                    model: "gemini-2.5-flash",
                    contents: { parts },
                });

                return response.text || "NO_DATA_RETURNED";
            } catch (error) {
                console.error("Gemini Error:", error);
                return "ERROR: ANALYSIS_PROTOCOL_FAILED. CONNECTION_INTERRUPTED.";
            }
        }

        // --- RENDER FUNCTIONS ---
        const appContainer = document.getElementById("app");

        function renderList() {
            window.scrollTo(0, 0);
            let html = `<div class="w-full flex flex-col items-center">`;

            // Artwork Items
            SAMPLE_ARTWORKS.forEach((artwork) => {
                html += `
            <div
              class="w-full mb-32 flex flex-col items-center cursor-pointer group js-artwork-item"
              data-id="${artwork.id}"
            >
              <div class="relative w-full aspect-[4/3] bg-white border border-black overflow-hidden flex items-center justify-center">
                <span class="text-[10px] uppercase tracking-widest opacity-60">NO IMAGE</span>
              </div>

              <div class="mt-8 text-center space-y-1.5">
                <div class="text-[10px] font-bold uppercase tracking-wide">
                  ${artwork.title} & ${artwork.artist}
                </div>
                <div class="text-[10px] text-gray-600 uppercase tracking-wide">
                  ${artwork.medium} — Coordinates: 52°30'24.8"N
                </div>
                <div class="text-[10px] text-gray-600 uppercase tracking-wide">
                  13°17'03.6"E
                </div>
                <div class="text-[10px] text-gray-600 uppercase tracking-wide">
                  ${artwork.status}, ${artwork.lotNumber}, ${artwork.year}
                </div>
              </div>
            </div>
          `;
            });

            // Placeholder Item (border stays black)
            html += `
          <div class="w-full max-w-sm mb-32 flex flex-col items-center pointer-events-none">
            <div class="w-full aspect-[3/4] border border-black bg-white flex items-center justify-center">
              <span class="text-[9px] uppercase tracking-widest opacity-30">No Signal</span>
            </div>
            <div class="mt-8 text-center space-y-1.5 opacity-30">
              <div class="text-[10px] font-bold uppercase tracking-wide">Null Reference</div>
              <div class="text-[10px] text-black uppercase tracking-wide">System Placeholder — 00°00'00.0"N</div>
              <div class="text-[10px] text-black uppercase tracking-wide">Semper, Lacinia, 1997</div>
            </div>
          </div>
        `;

            // Footer
            html += `
          <div class="w-full mt-20 flex flex-col md:flex-row items-end justify-between pt-8">
            <div class="w-24 h-24 bg-black mb-6 md:mb-0"></div>
            <div class="max-w-md text-right">
              <p class="text-[9px] uppercase leading-relaxed text-black">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Mauris euismod in felis non mattis.
              </p>
            </div>
          </div>
        </div>`;

            appContainer.innerHTML = html;

            // Add Event Listeners
            document.querySelectorAll(".js-artwork-item").forEach((el) => {
                el.addEventListener("click", () => {
                    selectedArtworkId = el.dataset.id;
                    renderDetail(selectedArtworkId);
                });
            });
        }

        function renderDetail(id) {
            const artwork = SAMPLE_ARTWORKS.find((a) => a.id === id);
            if (!artwork) return renderList();

            const existingAnalysis = analysisData[id] || "";

            const html = `
          <div class="fixed inset-0 z-50 bg-white flex flex-col font-mono text-sm h-[100dvh]">
            <!-- Mobile Back Button -->
            <div class="border-b border-black p-2 flex justify-between bg-white md:hidden">
              <button id="btn-back-mobile" class="text-xs font-bold">[ BACK ]</button>
            </div>

            <div class="flex-1 flex flex-col md:flex-row h-full overflow-hidden min-h-0">
              <!-- Left: Image -->
              <div class="md:w-1/2 border-b md:border-b-0 md:border-r border-black p-4 md:p-8 flex items-center justify-center bg-white relative">
                <div class="w-full max-w-[520px] aspect-[4/3] border border-black bg-white flex items-center justify-center">
                  <span class="text-[10px] uppercase tracking-widest opacity-60">NO IMAGE</span>
                </div>
                <div class="absolute bottom-4 left-4 text-[10px] uppercase bg-white border border-black px-2">
                  REF: ${artwork.id}
                </div>
              </div>

              <!-- Right: Info -->
              <div class="md:w-1/2 flex flex-col h-full bg-white min-h-0">
                <div class="p-6 border-b border-black">
                  <h1 class="text-xl md:text-2xl font-bold uppercase mb-2">${artwork.title}</h1>
                  <div class="grid grid-cols-2 gap-y-1 text-xs uppercase tracking-wider">
                    <div>ARTIST: ${artwork.artist}</div>
                    <div>YEAR: ${artwork.year}</div>
                    <div>MEDIUM: ${artwork.medium}</div>
                    <div>STATUS: ${artwork.status}</div>
                  </div>
                </div>

                <!-- Tabs -->
                <div class="flex border-b border-black text-xs uppercase font-bold tracking-widest">
                  <button id="tab-btn-data" class="flex-1 py-3 text-center transition-colors bg-black text-white hover:bg-black hover:text-white">DATA</button>
                  <div class="w-[1px] bg-black"></div>
                  <button id="tab-btn-analysis" class="flex-1 py-3 text-center transition-colors hover:bg-black hover:text-white">AI_ANALYSIS</button>
                </div>

                <!-- Content Area -->
                <div class="flex-1 p-6 overflow-y-auto relative min-h-0">
                  <!-- DATA TAB -->
                  <div id="content-data" class="space-y-6">
                    <p class="text-justify leading-relaxed">${artwork.description}</p>
                    <div class="border border-black p-4 text-xs">
                      <div class="mb-2 font-bold">[ PROVENANCE ]</div>
                      <ul class="list-none space-y-1 pl-0">
                        <li>- ACQUIRED: DIRECT</li>
                        <li>- AUTHENTICATED: TRUE</li>
                        <li>- LOT: ${artwork.lotNumber}</li>
                      </ul>
                    </div>
                  </div>

                  <!-- ANALYSIS TAB -->
                  <div id="content-analysis" class="hidden h-full flex flex-col">
                    <div id="analysis-placeholder" class="${existingAnalysis || isAnalyzing ? "hidden" : "flex"} flex-1 flex-col items-center justify-center space-y-4">
                      <p class="text-center text-xs opacity-50 max-w-[200px]">
                        INITIATE NEURAL NETWORK ANALYSIS OF VISUAL DATA
                      </p>
                      <button id="btn-run-analysis" class="border border-black px-6 py-3 uppercase text-xs font-bold hover:bg-black hover:text-white transition-colors">
                        [ RUN_ANALYSIS ]
                      </button>
                    </div>

                    <div id="analysis-loading" class="${isAnalyzing ? "block" : "hidden"} animate-pulse text-xs uppercase">
                      > CONNECTING TO CLOUD...<br/>
                      > UPLOADING BYTES...<br/>
                      > PROCESSING TENSORS...
                    </div>

                    <div id="analysis-result" class="${existingAnalysis ? "block" : "hidden"} font-mono text-sm leading-relaxed whitespace-pre-wrap">
                      <span class="bg-black text-white px-1 text-xs mr-2">OUTPUT:</span><span id="analysis-text">${existingAnalysis}</span>
                    </div>
                  </div>
                </div>

                <!-- Footer Actions -->
                <div class="p-4 border-t border-black md:mt-auto hidden md:block">
                  <button id="btn-close-desktop" class="w-full border border-black py-3 text-xs uppercase font-bold hover:bg-black hover:text-white transition-colors">
                    [ CLOSE FILE ]
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;

            appContainer.innerHTML = html;

            // Event Binding for Detail View
            document.getElementById("btn-back-mobile")?.addEventListener("click", () => {
                selectedArtworkId = null;
                renderList();
            });
            document.getElementById("btn-close-desktop")?.addEventListener("click", () => {
                selectedArtworkId = null;
                renderList();
            });

            // Tabs
            const tabData = document.getElementById("tab-btn-data");
            const tabAnalysis = document.getElementById("tab-btn-analysis");
            const contentData = document.getElementById("content-data");
            const contentAnalysis = document.getElementById("content-analysis");

            tabData.addEventListener("click", () => {
                tabData.classList.add("bg-black", "text-white");
                tabAnalysis.classList.remove("bg-black", "text-white");
                contentData.classList.remove("hidden");
                contentAnalysis.classList.add("hidden");
            });

            tabAnalysis.addEventListener("click", () => {
                tabAnalysis.classList.add("bg-black", "text-white");
                tabData.classList.remove("bg-black", "text-white");
                contentAnalysis.classList.remove("hidden");
                contentData.classList.add("hidden");
            });

            // Analysis Logic
            const btnRunAnalysis = document.getElementById("btn-run-analysis");
            if (btnRunAnalysis) {
                btnRunAnalysis.addEventListener("click", async () => {
                    const placeholder = document.getElementById("analysis-placeholder");
                    const loading = document.getElementById("analysis-loading");
                    const resultDiv = document.getElementById("analysis-result");
                    const resultText = document.getElementById("analysis-text");

                    isAnalyzing = true;
                    placeholder.classList.add("hidden");
                    loading.classList.remove("hidden");

                    const result = await analyzeArtwork(artwork);
                    analysisData[artwork.id] = result;

                    isAnalyzing = false;
                    loading.classList.add("hidden");
                    resultText.textContent = result;
                    resultDiv.classList.remove("hidden");
                });
            }
        }

        // Initial Render
        renderList();
    </script>
</body>

</html>